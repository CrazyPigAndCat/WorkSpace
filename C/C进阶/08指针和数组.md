<!--
 * @Author: your name
 * @Date: 2021-09-22 14:15:40
 * @LastEditTime: 2021-09-23 09:40:02
 * @LastEditors: Please set LastEditors
 * @Description: In User Settings Edit
 * @FilePath: /WorkSpace/C/C进阶/08指针和数组.md
-->

# 指针和数组

### 指针运算

- 指针是一种特殊的变量，与整数的运算规则为

```C
p+n; --> (unsigned int)p + n*sizeof(*p);
```

> 结论：
> 当指针p指向一个同类型的数组的元素时：
> p+1将指向当前元素的下一个元素；
> p-1将指向当前元素的上一个元素。

- 指针之间只支持减法运算
- 参与减法运算的指针类型必须相同

```C
p1-p2;--> ((unsigned int)p1 - (unsigned int)p2)/sizeof(type);
```

> 注意：
>
> 1. 只有当两个指针指向相同一个数组中的元素时，指针相减才有意义，其意义为指针所指元素的下标差
> 2. 当两个指针指向的元素不在同一数组时，结果未定

- 指针的比较
  - 指针也可以进行比较关系运算(<,<=,>=,>)
  - 指针关系运算的前提是同时指向同一个数组中的元素
  - 任意两个指针之间比较运算（==，！=）无限制
  - 参与比较运算的指针类型必须相同

### 下标形式VS指针形式

- 指针以固定增量在数组中移动是，效率高于下标形式
- 指针增量1且硬件具有硬件增量模型时，效率高
- 下标形式与指针形式的转换

```C
a[n] <----> *(a+n) <----> *(n+a) <----> n[a]
```

> 注意：
> 现代编译器的生成代码优化率已大大提高，在固定增量时，下标形式的效率已经和指针形式相当；
> 但从可读性和代码维护性来看，下标更加优秀

### a与&a的区别

- a为数组首元素的地址
- &a为整个数组地址
- a和&a的区别在与指针运算

```C
a+1 --> (unsigned)a + sizeof(*a);
&a+1---> (unsigned)(&a) + sizeof(*&a)  ---> (unsigned)(&a)+sizeof(a)
```

### 数组参数
- 数组作为函数参数时，编译器将其编译成对应的指针

```C
void f(int a[]) <---> void f(int *a);
void f(int a[5]) <---> void f(int *a);
```

> 结论
> 一般情况下，当定义的函数中有数组参数时，需要定义另一个参数来表示数组的大小

### 小结

- 数组名和指针仅使用方式相同
  - 数组名的本质是指针
  - 指针的本质不是数组
- 数组名并不是数组的地址，而是数组首元素的地址
- 函数的数组参数退化为指针
