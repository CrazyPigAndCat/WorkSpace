<!--
 * @Author: your name
 * @Date: 2021-10-08 09:32:06
 * @LastEditTime: 2021-10-08 11:26:30
 * @LastEditors: Please set LastEditors
 * @Description: In User Settings Edit
 * @FilePath: /WorkSpace/C++/05函数参数与重载/05函数参数与重载.md
-->
# 函数参数与重载

## 函数参数

### 函数参数的默认值

- C++中可以在函数声明时为参数提供一个默认值
- 当函数调用时没有提供参数的值，则使用默认值
- 参数的默认值必须在函数声明中指定

### 函数参数的默认值

- 参数的默认值必须从右向左提供
- 函数调用时使用了默认值，则后续参数必须使用默认值

### 函数占位参数

- 在C++中可以为函数提供占位参数
  - 占位参数只有参数类型声明，而没有参数声明
  - 一般情况下，在函数体内部无法使用占位参数
- 函数占位参数的意义
  - 占位参数与默认参数结合起来使用
  - 兼容C语言程序中可能出现的不规范写法

### 小结

- C++中支持函数参数的默认值
- 如果函数调用时没有提供参数值，则使用默认值
- 参数的默认值必须从右向左提供
- 函数调用时使用了默认值，则后续参数必须使用默认值
- C++中支持占位参数，用于兼容C语言中的不规范语法



## 函数重载

### 重载的概念

> 同一标识符在不同的上下文有不同的意义

- 函数重载
  - 同一函数名定义不同的函数
  - 当函数名和不同的参数搭配时函数的含义不同
- 函数重载至少要满足下面的一个条件
  - 参数个数不同
  - 参数类型不同
  - 参数顺序不同

### C++中的函数重载

- 编译器调用重载函数的准则
  - 将所有同名函数作为候选者
  - 尝试寻找可行的候选函数
    - 精确匹配实参
    - 通过默认参数能够匹配实参
    - 通过默认类型转换匹配实参
  - 匹配失败
    - 最终寻找到的候选函数不唯一，出现了二义性，编译失败
    - 无法匹配所有候选者，函数未定义，编译失败

### 函数重载注意事项

- 重载函数在本质上是相互独立的不同函数
- 重载函数的函数类型不同
- 函数返回值不能作为函数重载的依据

> 函数重载是由函数名和参数列表决定

```C
#include <stdio.h>

int add(int a,int b)
{
    return a+b;
}
int add(int a,int b, int c)
{
    return a+b+c;
}
int main(int argc, char const *argv[])
{
    printf("%p\n",(int(*)(int,int))add);
    printf("%p\n",(int(*)(int,int,int))add);
    return 0;
}
```

### 小结

- 函数重载是C++中引入的概念
- 函数重载用于模拟自然语言中的词汇搭配
- 函数重载使用C++具有更丰富的语义表达能力
- 函数重载的本质为相互独立的不同函数
- C++中通过函数名和函数参数确定函数调用

## 重载与指针

- 函数重载遇上函数指针
  - 将重载函数名赋值给函数指针时
    - 根据重载规则挑选与函数指针参数列表一致的候选者
    - 严格匹配候选者的函数类型与函数指针的函数类型

> 注意
> - 函数重载必然发生在同一个作用域中
> - 编译器需要用参数列表或函数类型进行函数选择
> - 无法直接通过函数名得到重载函数的入口地址

### C++和C相互调用

- 实际工程中C++和C代码相互调用是不可避免的
- C++编译器能够兼容C语言的编译方式
- C++编译器会优化使用C++编译方式
- extern关键字能强制让C++编译器进行C方式编译

```C
extern "C"
{
    
}
```

### 解决C++中使用C编译器方案

- __cplusplus是C++编译器内置的标准宏定义
- __cplusplus的意义
  - 确保C代码以统一的C方式被编译成目标文件

```C
#ifdef __cplusplus
extern "C"{
#endif
//C Compilation

#ifdef __cplusplus
}
#endif
```

> 注意
> - C++编译器不能以C的方式编译重载函数
> - 编译方式决定函数被编译后的目标名
>   - C++编译方式将函数名和参数列表编译成目标名
>   - C编译方式只将函数名作为目标名进行编译

### 小结

- 函数重载是C++对C的一个重要升级
- 函数重载通过函数参数列表区分不同的同名函数
- extern关键字能够实现C和C++的相互调用
- 编译方式决定符号表中的函数名的最终目标名

